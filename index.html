<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Cookie Clicker Brainrot</title>
  <style>
    body{background:#0f0f1a;color:#f0f0f0;font-family:"Segoe UI",sans-serif;display:flex;flex-direction:column;align-items:center;padding:20px;margin:0}
    h1,h2{color:#8be9fd;margin:5px 0}
    .countdown-container{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;max-width:800px;width:100%;margin-bottom:40px}
    .time-box{background:#1a1a2e;border-radius:16px;padding:20px;text-align:center;box-shadow:0 0 10px rgba(0,0,0,.5);position:relative}
    .time-box h2{font-size:2.5em;margin:0}
    .bar-container{position:absolute;bottom:0;left:0;height:6px;width:100%;background:#2e2e3a;border-radius:0 0 16px 16px;overflow:hidden}
    .bar{height:100%;width:0;background:linear-gradient(90deg,#00d2ff,#3a47d5);transition:width 1s linear}
    .clicker{background:#1a1a2e;padding:30px;border-radius:16px;box-shadow:0 0 15px rgba(0,0,0,.5);text-align:center;width:90%;max-width:500px}
    .cookie{width:120px;height:120px;border-radius:50%;background:url('https://cdn.discordapp.com/attachments/1330726807229436004/1386095520858247309/supergrave.PNG?ex=6858758c&is=6857240c&hm=1ab6353353329bdd7feee3fefef39d11a5af9412c4b432c982a31b0111d71c54&') no-repeat center/cover;margin:20px auto;cursor:pointer;transition:transform .1s}
    .cookie:active{transform:scale(.9)}
    button{margin:8px;padding:10px 20px;background:#3a47d5;color:#fff;border:none;border-radius:8px;cursor:pointer}
    button:hover{background:#5f66e8}
    #event{margin-top:10px;font-weight:bold;color:#f1fa8c;min-height:24px}
    #stats{margin-top:10px;font-size:.9em;color:#bbb}
    .sidebar,.sidebar-left{position:fixed;top:20px;width:240px;background:#1a1a2e;padding:20px;border-radius:12px;box-shadow:0 0 10px rgba(0,0,0,.6);font-size:.9em;overflow-y:auto;max-height:90vh}
    .sidebar{right:20px}
    .sidebar-left{left:20px}
    .sidebar h3,.sidebar-left h3{margin:0 0 8px}
    .sidebar h3{color:#ffb86c}
    .sidebar-left h3{color:#50fa7b}
    .sidebar details{margin-bottom:10px}
    .sidebar-left ul{padding-left:20px}
    .talent-grid {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 20px;
  padding: 10px 0;
}

.talent-card{
  width:90px;           /* 110 → 90 px */
  height:90px;
  background:#1a1a2e;
  border:2px solid #444;
  border-radius:16px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.7em;      /* 2 → 1.7 em */
  color:#fff;
  box-shadow:0 0 10px #0008;
  cursor:pointer;
  transition:transform .2s,border-color .2s;
  position:relative;
}
.talent-card::after{
  content:attr(data-name);
  font-size:.6em;       /* 0.7 → 0.6 em */
  color:#f1fa8c;
  position:absolute;
  bottom:-1.4em;
  width:100%;
  text-align:center;
  line-height:1.1em;
}

.event-message {
  transition: opacity 1s ease;
}

.event-message.fading {
  opacity: 0;
}


  </style>
</head>
<body>
  <div id="floating-events" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999;"></div>
  <h1>⏳ Temps restant avant le déban 😭</h1>
  <div class="countdown-container">
    <div class="time-box"><h2 id="days">0</h2><span>Jours</span><div class="bar-container"><div class="bar" id="bar-days"></div></div></div>
    <div class="time-box"><h2 id="hours">0</h2><span>Heures</span><div class="bar-container"><div class="bar" id="bar-hours"></div></div></div>
    <div class="time-box"><h2 id="minutes">0</h2><span>Minutes</span><div class="bar-container"><div class="bar" id="bar-minutes"></div></div></div>
    <div class="time-box"><h2 id="seconds">0</h2><span>Secondes</span><div class="bar-container"><div class="bar" id="bar-seconds"></div></div></div>
  </div>
  <div id="message"></div>

  <div class="clicker">
    <h2>🍪 Cookie Clicker Brainrot</h2>
    <div class="cookie" onclick="clickCookie()"></div>
    <div id="cookie-count">Cookies : 0</div>
    <div id="stats">CPS: 0 | Clics: 0 | Prestige: 0x</div>
    <button onclick="buyUpgrade()">Acheter Auto-Click (<span id="autoCost">10</span> cookies)</button>
    <button onclick="buyMultiplier()">Multiplicateur (coût : <span id='multCost'>50</span>)</button>
    <button onclick="prestige()">Prestige (10 000 cookies)</button>
    <button onclick="desespoir()">Crier au désespoir</button>
    <button onclick="resetGame()" style="background:#ff5555">Réinitialiser</button>

  <div id="event"></div>

<div id="event-log"
     style="margin-top:15px;font-size:.85em;text-align:left;max-height:150px;overflow-y:auto;background:#121225;padding:10px;border-radius:8px">
</div>

  <div class="sidebar" id="sidebar">
    <h3>📊 Stats joueur</h3>
    <div>✨ Prestige : <span id="infoPrestige">0</span></div>
    <div>🔁 Auto-clickers : <span id="infoAuto">0</span></div>
    <div>👆 Puissance clic : <span id="infoClic">1</span></div>
    <div>📈 Multiplicateur : <span id="infoMulti">1</span>x</div>
    <div>🍀 Chance : <span id="infoChance">1.0</span>x</div>
    <h3>🎲 Rareté des événements</h3>
    <details><summary>🟢 Commun : 60%</summary><ul><li>Bonus mineurs (cookies, clics…)</li></ul></details>
    <details><summary>🔵 Rare : 30%</summary><ul><li>Multiplicateurs légers, auto-clicker bonus…</li></ul></details>
    <details><summary>🟣 Épique : 9%</summary><ul><li>Gros boosts, prestige +1…</li></ul></details>
    <details><summary>🟡 Légendaire : 1%</summary><ul><li>Récompenses massives (×2 cookies, +5 auto…)</li></ul></details>
  </div>

  <div class="sidebar-left" id="achievementSidebar">
    <h3>🏆 Succès débloqués</h3>
    <ul id="achievementsUnlocked"></ul>
    <h3>🔒 À débloquer</h3>
    <ul id="achievementsLocked">
  <li>👆 100 clics</li>
  <li>🍪 1000 cookies</li>
  <li>🔁 10 autoclickers</li>
  <li>🧨 1000 clics</li>
  <li>💰 10k cookies</li>
  <li>🧟 Survivant 10 min</li>
      <li>👆 100 clics</li>
      <li>🍪 1000 cookies</li>
      <li>🔁 10 autoclickers</li>
    
  <li>🕳️ Cliquez 666 fois</li>
  <li>🌑 Joué à minuit</li>
  <li>👻 Page restée ouverte 1h</li>
  <li>🎩 Cliquez 42 fois en 10 secondes</li>
  <li>🐱‍👤 Activer le mode secret</li>
  <li>🔱 Prestige x10</li>
<li>💸 1 million de cookies</li>
<li>🤖 100 auto-clickers</li>
<li>🧠 10 000 clics</li>
<li>🕰️ Joué pendant 3h</li>
<li>🌌 Prestige x25</li>
<li>📉 Réinitialisé 10 fois</li>
<li>🐉 Ultra clic : 500 clics en 10 sec</li>

  </ul>
  </div>

<!-- === TALENT TREE ================================================= -->
<section id="talent-tree-section" style="margin-top:40px">
  <h2 style="text-align:center;color:#00d8ff">✨ Arbre de Talents</h2>
  <div style="text-align:center;margin-bottom:20px;color:#50fa7b">
    Points disponibles : <span id="talentPoints">0</span>
  </div>

  <!-- Améliorations classiques -->
  <h3 style="color:#f1fa8c;text-align:center">🧩 Améliorations</h3>
  <div class="talent-grid">
    <div class="talent-card"        onclick="unlockTalent(0)" data-name="Force du clic">💪</div>
    <div class="talent-card locked" onclick="unlockTalent(1)" data-name="AutoPro">⚙️</div>
    <div class="talent-card locked" onclick="unlockTalent(2)" data-name="Cookies offline">🌙</div>
    <div class="talent-card locked" onclick="unlockTalent(3)" data-name="Événements +">🎁</div>
    <div class="talent-card locked" onclick="unlockTalent(4)" data-name="Double prestige">🔄</div>
  </div>

  <!-- Talents spéciaux -->
  <h3 style="color:#f1fa8c;text-align:center;margin-top:25px">🧪 Spéciaux</h3>
  <div class="talent-grid">
    <div class="talent-card locked" onclick="unlockTalent(5)" data-name="Clic fantôme">👻</div>
    <div class="talent-card locked" onclick="unlockTalent(6)" data-name="Commentateur">💬</div>
    <div class="talent-card locked" onclick="unlockTalent(7)" data-name="Inertie">🧊</div>
    <div class="talent-card locked" onclick="unlockTalent(8)" data-name="Événement truqué">🎲</div>
    <div class="talent-card locked" onclick="unlockTalent(9)" data-name="Clic miroir">🧤</div>
  </div>
</section>
<!-- ================================================================= -->

  <script>
// === Script JavaScript complet ===

const bar_days = document.getElementById("bar-days"),
      bar_hours = document.getElementById("bar-hours"),
      bar_minutes = document.getElementById("bar-minutes"),
      bar_seconds = document.getElementById("bar-seconds");
const targetDate = new Date("2025-06-27T20:28:00Z");

function updateCountdown() {
  const now = new Date(), total = targetDate - now;
  if (total <= 0) {
    document.getElementById("message").textContent = "✅ Tu es débanni !";
    return;
  }
  const s = Math.floor(total / 1e3) % 60,
        m = Math.floor(total / 6e4) % 60,
        h = Math.floor(total / 36e5) % 24,
        d = Math.floor(total / 864e5);
  days.textContent = d;
  hours.textContent = h;
  minutes.textContent = m;
  seconds.textContent = s;
  bar_days.style.width = Math.min((d % 30) / 30 * 100, 100) + "%";
  bar_hours.style.width = (h / 24 * 100) + "%";
  bar_minutes.style.width = (m / 60 * 100) + "%";
  bar_seconds.style.width = (s / 60 * 100) + "%";
}
setInterval(updateCountdown, 1000);
updateCountdown();

let cookies = 0, autoClickers = 0, clickPower = 1, prestigeBonus = 0;
let globalMultiplier = 1, multiplierCost = 50, totalClicks = 0, cps = 0;
let achievements = [];
let rapidClicks = 0;
document.addEventListener("click", () => {
  rapidClicks++;
  setTimeout(() => {
  div.classList.add("fading");
  setTimeout(() => div.remove(), 1000);
}, duration);
});
const eventLog = [];

function updateDisplay() {
  document.getElementById("cookie-count").textContent = "Cookies : " + Math.floor(cookies);
  document.getElementById("stats").textContent = `CPS: ${cps.toFixed(1)} | Clics: ${totalClicks} | Prestige: ${prestigeBonus}x`;
  infoPrestige.textContent = prestigeBonus;
  document.getElementById("autoCost").textContent = 10 * Math.pow(2, autoClickers);
  infoClic.textContent = clickPower;
  infoMulti.textContent = globalMultiplier;
  multCost.textContent = multiplierCost;
  infoChance.textContent = (window.eventRarityBoost||1).toFixed(1);
}

function clickCookie() {
  cookies += clickPower * globalMultiplier * (1 + prestigeBonus);
  totalClicks++;
  updateDisplay();
}
function buyUpgrade(){
  const cost = 10 * Math.pow(2, autoClickers);          // coût actuel
  if(cookies < cost) return alert(`Il te faut ${cost} cookies !`);
  cookies -= cost;
  autoClickers++;
  updateDisplay();                                      // met à jour l’UI
}
function buyMultiplier() {
  if (cookies < multiplierCost) return alert("Pas assez de cookies !");
  cookies -= multiplierCost;
  globalMultiplier++;
  multiplierCost *= 2;
  updateDisplay();
}
function prestige() {
  let prestigeCost = 10000 * Math.pow(2, prestigeBonus);
  if (cookies < prestigeCost) return alert(`Il te faut ${prestigeCost} cookies pour transcender.`);
  if (confirm("Prestige ? Tu perds tout mais gagnes un bonus permanent !")) {
    prestigeBonus+= window.doublePrestige ? 2 : 1;
    talentPoints++;
  saveTalents();
  document.getElementById("talentPoints").textContent = talentPoints;

    cookies = 0;
    autoClickers = prestigeBonus; // +1 autoClicker par prestige
    clickPower = 1 + prestigeBonus; // +1 puissance de clic par prestige
    globalMultiplier = 1;
    multiplierCost = 50;
    totalClicks = 0;
    cps = 0;
    achievements = [];

    document.getElementById("achievementsUnlocked").innerHTML = "";
    document.getElementById("achievementsLocked").innerHTML = `
      <li>👆 100 clics</li>
      <li>🍪 1000 cookies</li>
      <li>🔁 10 autoclickers</li>
      <li>🧨 1000 clics</li>
      <li>💰 10k cookies</li>
      <li>🧟 Survivant 10 min</li>
      <li>🕳️ Cliquez 666 fois</li>
      <li>🌑 Joué à minuit</li>
      <li>👻 Page restée ouverte 1h</li>
      <li>🎩 Cliquez 42 fois en 10 secondes</li>
      <li>🐱‍👤 Activer le mode secret</li>
      <li>🔱 Prestige x10</li>
      <li>💸 1 million de cookies</li>
      <li>🤖 100 auto-clickers</li>
      <li>🧠 10 000 clics</li>
      <li>🕰️ Joué pendant 3h</li>
      <li>🌌 Prestige x25</li>
      <li>📉 Réinitialisé 10 fois</li>
      <li>🐉 Ultra clic : 500 clics en 10 sec</li>
    `;
    updateDisplay();
  }
}
function resetGame(){
  if (!confirm("Tout effacer ?")) return;

  /* 👉 1) réinitialise complètement l’arbre */
  resetTalents();                                   // ⬅️ IMPORTANT

  /* 👉 2) supprime la sauvegarde normale et les flags offline   */
  localStorage.removeItem("save");
  localStorage.removeItem("enableOffline");
  localStorage.removeItem("lastSeen");

  /* 👉 3) compte les resets, si tu utilises ce succès           */
  localStorage.setItem("resetCount",
      (parseInt(localStorage.getItem("resetCount")||"0")+1)+"");

  /* 👉 4) remets toutes les variables de jeu à zéro             */
  cookies = 0;
  autoClickers = 0;
  clickPower   = 1;
  prestigeBonus = 0;
  globalMultiplier = 1;
  multiplierCost   = 50;
  totalClicks = 0;
  cps = 0;

  /* 👉 5) vide listes de succès affichés (si tu les réinitialises) */
  document.getElementById("achievementsUnlocked").innerHTML = "";
  /* …re‐génère ton UL verrouillé si besoin… */

  updateDisplay();          // rafraîchit l’UI

  /* 👉 6) recharge la page pour repartir clean */
  location.reload();

  resetTalents();
  localStorage.removeItem("unlockedAchievements");
  unlockedAchievements = [];
  document.getElementById("achievementsUnlocked").innerHTML = "";
  localStorage.removeItem("achievement_reset_addict");
  localStorage.removeItem("achievement_secret_mode");
  localStorage.removeItem("achievement_konami_master");

  // Supprime les succès spéciaux
localStorage.removeItem("unlockedAchievements");
localStorage.removeItem("achievement_reset_addict");
localStorage.removeItem("achievement_secret_mode");
localStorage.removeItem("achievement_konami_master");

// OU version dynamique
for (let key in localStorage) {
  if (key.startsWith("achievement_")) {
    localStorage.removeItem(key);
  }
}

// Nettoie affichage et variables
unlockedAchievements = [];
document.getElementById("achievementsUnlocked").innerHTML = "";
resetAddictUnlocked = false;
secretModeUnlocked = false;
konamiMasterUnlocked = false;

}


function desespoir() {
  alert("NO NOO LA POLIZIA 😭");
}
setInterval(() => {
  const gained = autoClickers * globalMultiplier * (1 + prestigeBonus);
  cookies += gained;
  cps = gained;
  updateDisplay();
}, 1000);

function save() {
  localStorage.setItem("save", JSON.stringify({
    cookies, autoClickers, clickPower, prestigeBonus,
    globalMultiplier, multiplierCost, totalClicks, achievements
  }));
}
function load() {
  const s = localStorage.getItem("save");
  if (!s) return;
  const d = JSON.parse(s);
  cookies = d.cookies || 0;
  autoClickers = d.autoClickers || 0;
  clickPower = d.clickPower || 1;
  prestigeBonus = d.prestigeBonus || 0;
  globalMultiplier = d.globalMultiplier || 1;
  multiplierCost = d.multiplierCost || 50;
  totalClicks = d.totalClicks || 0;
  achievements = d.achievements || [];
// Restaurer succès affichés
  for (const id of achievements) {
    const labels = {
      "c100": "👆 100 clics",
      "ck1k": "🍪 1000 cookies",
      "ac10": "🔁 10 autoclickers",
      "mega1k": "🧨 1000 clics",
      "rich10k": "💰 10k cookies",
      "zombie": "🧟 Survivant 10 min",
      "darkclick": "🕳️ Cliquez 666 fois",
      "ninja": "🐱‍👤 Mode secret activé",
      "troll": "😵 Reset addict",
      "invisibleEgg": "🥚 Œuf caché découvert",
      "foxie": "🦊 Navigateur loyal",
      "leet": "⌚ L'heure sacrée : 13h37",
      "konami": "🎮 Konami master",
    };
    if (labels[id]) {
      const li = document.createElement("li");
      li.textContent = labels[id];
      document.getElementById("achievementsUnlocked").appendChild(li);
      [...document.getElementById("achievementsLocked").children].forEach(child => {
        if (child.textContent === labels[id]) child.remove();
      });
    }
  }
}
load();
updateDisplay();
setInterval(save, 5000);

let timePlayed = 0; // ✅ Temps total joué


function checkAchievements() {
  const unlocked = [];
  const unlock = (id, label) => {
    if (!achievements.includes(id)) {
      achievements.push(id);
      unlocked.push(label);
      const li = document.createElement("li");
      li.textContent = label;
      document.getElementById("achievementsUnlocked").appendChild(li);
      const lockedList = document.getElementById("achievementsLocked");
      [...lockedList.children].forEach(child => {
        if (child.textContent === label) lockedList.removeChild(child);
      });

      // animation pour mystères
      const mysteryIds = ["darkclick","midnight","hourstay","spammer","ninja","invisibleEgg","foxie","leet","konami"];
      if (mysteryIds.includes(id)) {
        const flash = document.createElement("div");
        flash.textContent = "🎉 Succès mystère débloqué !";
        flash.style.position = "fixed";
        flash.style.top = "30%";
        flash.style.left = "50%";
        flash.style.transform = "translate(-50%, -50%)";
        flash.style.background = "#111";
        flash.style.color = "#fff";
        flash.style.padding = "20px";
        flash.style.borderRadius = "12px";
        flash.style.zIndex = "9999";
        flash.style.fontSize = "1.5em";
        flash.style.boxShadow = "0 0 20px #fff";
        document.body.appendChild(flash);
        setTimeout(() => flash.remove(), 3000);
      }
      // animation spéciale œuf
      if (id === "invisibleEgg") {
        const glow = document.createElement("div");
        glow.textContent = "🥚 Succès secret découvert !";
        glow.style.position = "fixed";
        glow.style.top = "30%";
        glow.style.left = "50%";
        glow.style.transform = "translate(-50%, -50%)";
        glow.style.background = "gold";
        glow.style.color = "#000";
        glow.style.padding = "25px";
        glow.style.borderRadius = "14px";
        glow.style.zIndex = "10000";
        glow.style.fontSize = "1.6em";
        glow.style.fontWeight = "bold";
        glow.style.boxShadow = "0 0 30px gold";
        document.body.appendChild(glow);
        setTimeout(() => glow.remove(), 4000);
      }
    }
  };

  // Succès standards
  if (totalClicks >= 100) unlock("c100", "👆 100 clics");
  if (cookies >= 1000) unlock("ck1k", "🍪 1000 cookies");
  if (autoClickers >= 10) unlock("ac10", "🔁 10 autoclickers");

  // Nouveaux succès
  if (totalClicks >= 1000) unlock("mega1k", "🧨 1000 clics");
  if (cookies >= 10000) unlock("rich10k", "💰 10k cookies");
  if (timePlayed >= 600) unlock("zombie", "🧟 Survivant 10 min");
  if (totalClicks >= 666) unlock("darkclick", "🕳️ Cliquez 666 fois");
  if (prestigeBonus >= 10) unlock("prestige10", "🔱 Prestige x10");
if (cookies >= 1000000) unlock("millionaire", "💸 1 million de cookies");
if (autoClickers >= 100) unlock("auto100", "🤖 100 auto-clickers");
if (totalClicks >= 10000) unlock("click10k", "🧠 10 000 clics");
if (timePlayed >= 10800) unlock("longplay", "🕰️ Joué pendant 3h");
if (prestigeBonus >= 25) unlock("prestige25", "🌌 Prestige x25");

const resetCountHardcore = parseInt(localStorage.getItem("resetCount") || "0");
if (resetCountHardcore >= 10) unlock("reset10", "📉 Réinitialisé 10 fois");

if (rapidClicks >= 500) unlock("ultraclick", "🐉 Ultra clic : 500 clics en 10 sec");

  // Mystiques
  const date = new Date();
  if (date.getHours() === 0) unlock("midnight", "🌑 Joué à minuit");
  if (navigator.userAgent.toLowerCase().includes("firefox")) unlock("foxie", "🦊 Navigateur loyal");
  if (date.getHours() === 13 && date.getMinutes() === 37) unlock("leet", "⌚ L'heure sacrée : 13h37");

  const resetCount = parseInt(localStorage.getItem("resetCount") || "0");
  if (resetCount >= 5) unlock("troll", "😵 Reset addict");

  if (totalClicks === 123 && autoClickers === 4 && globalMultiplier === 2) {
    unlock("invisibleEgg", "🥚 Œuf caché découvert");
  }

  // Mode secret et spam
  if (rapidClicks >= 42) unlock("spammer", "🎩 Cliquez 42 fois en 10 secondes");
  if (localStorage.getItem("secret") === "true") unlock("ninja", "🐱‍👤 Mode secret activé");

  // Konami code via flag
  if (localStorage.getItem("konamiUnlock") === "1") unlock("konami", "🎮 Konami master");

  if (unlocked.length) alert("Succès débloqués :" + unlocked.join(""));
}

setInterval(checkAchievements, 5000);
setInterval(() => timePlayed++, 1000); // ✅ compteur de temps
  const unlocked = [];
  const unlock = (id, label) => {

      const isMystery = ["darkclick", "midnight", "hourstay", "spammer", "ninja"].includes(id);
      if (isMystery) {
        const flash = document.createElement("div");
        flash.textContent = "🎉 Succès mystère débloqué !";
        flash.style.position = "fixed";
        flash.style.top = "30%";
        flash.style.left = "50%";
        flash.style.transform = "translate(-50%, -50%)";
        flash.style.background = "#111";
        flash.style.color = "#fff";
        flash.style.padding = "20px";
        flash.style.borderRadius = "12px";
        flash.style.zIndex = "9999";
        flash.style.fontSize = "1.5em";
        flash.style.boxShadow = "0 0 20px #fff";
        document.body.appendChild(flash);
        setTimeout(() => flash.remove(), 3000);
if (id === "invisibleEgg") {
        const glow = document.createElement("div");
        glow.textContent = "🥚 Succès secret découvert !";
        glow.style.position = "fixed";
        glow.style.top = "30%";
        glow.style.left = "50%";
        glow.style.transform = "translate(-50%, -50%)";
        glow.style.background = "gold";
        glow.style.color = "#000";
        glow.style.padding = "25px";
        glow.style.borderRadius = "14px";
        glow.style.zIndex = "10000";
        glow.style.fontSize = "1.6em";
        glow.style.fontWeight = "bold";
        glow.style.boxShadow = "0 0 30px gold";
        document.body.appendChild(glow);
        setTimeout(() => glow.remove(), 4000);
      }
      }

    if (!achievements.includes(id)) {
      achievements.push(id);
      unlocked.push(label);
      const li = document.createElement("li");
      li.textContent = label;
      document.getElementById("achievementsUnlocked").appendChild(li);
      const lockedList = document.getElementById("achievementsLocked");
      [...lockedList.children].forEach(child => {
        if (child.textContent === label) lockedList.removeChild(child);
      });
    }
  };
  if (totalClicks >= 100) unlock("c100", "👆 100 clics");
  if (cookies >= 1000) unlock("ck1k", "🍪 1000 cookies");
  if (autoClickers >= 10) unlock("ac10", "🔁 10 autoclickers");
  if (unlocked.length) alert("Succès débloqués:" + unlocked.join(""));

function toggleSecret() {
  const enabled = localStorage.getItem("secret") === "true";
  if (enabled) {
    alert("Mode secret désactivé.");
    localStorage.removeItem("secret");
  } else {
    alert("🐱‍👤 Mode secret activé !");
    localStorage.setItem("secret", "true");
  }
}

setInterval(checkAchievements, 5000);
  
(function(){
  if (window.konamiInit) return;
  window.konamiInit = true;
  const konamiCode = ["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"];
  let inputSequence = [];
  document.addEventListener("keydown", (e) => {
    inputSequence.push(e.key);
    if (inputSequence.length > 10) inputSequence.shift();
    if (inputSequence.join(",") === konamiCode.join(",")) {
      localStorage.setItem("konamiUnlock", "1");
      alert("🎮 Konami code réussi !");
    }
  });
})();

function triggerRandomEvent() {
  /* 1) chance ajustée par le talent “Événements rares +” */
  const boost   = window.eventRarityBoost || 1;           // 1 (normal) ou 1.5
  const roll    = Math.random() * 100 / boost;            // ← seule fois
  let  message  = "";

  if (roll < 55) {                                        // Commun
    const bonus = Math.floor(Math.random() * 20 + 10);    // 10-29 cookies
    cookies += bonus;
    message = `🟢 Bonus commun : +${bonus} cookies`;

  } else if (roll < 85) {                                 // Rare
    autoClickers++;
    message = `🔵 Rare : +1 auto-clicker !`;

  } else if (roll < 98) {                                 // Épique
    globalMultiplier++;
    message = `🟣 Épique : multiplicateur +1 !`;

  } else if (roll < 99.5) {                               // Légendaire
    cookies *= 2;
    message = `🟡 Légendaire : Cookies x2 !`;

  } else {                                                // Bonus interactif
    message = "🌟 BONUS INTERACTIF : Clique les cookies flottants !";
    for (let i = 0; i < 7; i++) {
      spawnFloatingCookie("🍪 +77", () => {
        cookies += 77;
        updateDisplay();
      });
    }
  }

  /* 2) Affiche + log */
  const eventDiv = document.getElementById("event");
  eventDiv.textContent = message;

  eventLog.unshift(message);
  document.getElementById("event-log").innerHTML =
    eventLog.slice(0, 5).map(e => `<div>${e}</div>`).join("");
  updateDisplay();

  /* 3) Efface automatiquement le message entre 5 et 10 s */
  const duration = 5000 + Math.random() * 5000;           // 5-10 s
  setTimeout(() => {
    if (eventDiv.textContent === message) {               // évite d’effacer un nouveau msg
      eventDiv.textContent = "";
    }
  }, duration);
}


function spawnFloatingCookie(text, bonusCallback) {
  const el = document.createElement("div");
  el.textContent = text;
  el.style.position = "absolute";
  el.style.top = Math.random() * 80 + 10 + "%";
  el.style.left = Math.random() * 80 + 10 + "%";
  el.style.padding = "10px 14px";
  el.style.background = "#ffc107";
  el.style.color = "#000";
  el.style.borderRadius = "12px";
  el.style.fontWeight = "bold";
  el.style.cursor = "pointer";
  el.style.boxShadow = "0 0 10px #fff";
  el.style.transition = "transform 0.2s ease";
  el.style.pointerEvents = "auto";
  el.style.zIndex = 10000;

  el.onclick = () => {
    bonusCallback();
    el.remove();
  };

  document.getElementById("floating-events").appendChild(el);
  setTimeout(() => el.remove(), 10000); // Disparaît après 10 sec si non cliqué
}

function spawnBonusCookieRandomly() {
  const delay = Math.random() * 20000 + 10000; // entre 10k et 30k ms (10-30s)
  setTimeout(() => {
    spawnFloatingCookie("🍪 +99", () => {
      cookies += 99;
      updateDisplay();
    });
    spawnBonusCookieRandomly(); // relancer pour boucle infinie
  }, delay);
}

/* ------------ CONFIG ---------------------------------- */
const CYCLE_SECONDS   = 600;   // 10 min
const DISPLAY_FORMAT  = true;  // mm:ss au lieu de valeur brute
/* ------------------------------------------------------- */

let eventCountdown = CYCLE_SECONDS; // temps restant (en s)
let eventActive    = false;         // false = attente, true = événement affiché

setInterval(() => {
  eventCountdown--;

  /* -- Quand le compte à zéro arrive ------------------- */
  if (eventCountdown <= 0) {

    if (!eventActive) {             // ► LANCER l’événement
      triggerRandomEvent();         //  (ta fonction existe déjà)
      eventActive    = true;
      eventCountdown = CYCLE_SECONDS;   // durée d’affichage (10 min)

    } else {                        // ► TERMINER l’événement
      document.getElementById("event").textContent = "";
      eventActive    = false;
      eventCountdown = CYCLE_SECONDS;   // nouvelle attente (10 min)
    }
  }

  /* -- Affichage du timer ------------------------------ */
  const out = DISPLAY_FORMAT
      ? `${Math.floor(eventCountdown/60)
           .toString().padStart(2,"0")}:${(eventCountdown%60)
           .toString().padStart(2,"0")}`
      : eventCountdown;

  document.getElementById("eventCountdown").textContent = out;

}, 1000);


spawnBonusCookieRandomly(); // lancer une première fois

/* === TALENTS (10) =============================================== */
const TALENT_COUNT = 10;
let talentPoints   = +localStorage.getItem("talentPoints") || 0;
const talents      = JSON.parse(localStorage.getItem("talents")||"[]");
while (talents.length < TALENT_COUNT) talents.push(false);

function saveTalents(){
  localStorage.setItem("talentPoints", talentPoints);
  localStorage.setItem("talents", JSON.stringify(talents));
}

/* ⏹️ Stocke ici tous les interval-ID créés par les talents */
window.talentIntervals ??= [];

/* 🔓 Achat d’un talent ------------------------------------------------ */
function unlockTalent(i){
  if (talents[i]) return;               // déjà acquis
  if (i>0 && !talents[i-1]) return;     // progression
  if (talentPoints<=0) return;

  talents[i] = true;
  talentPoints--;
  document.getElementById("talentPoints").textContent = talentPoints;
  const card = document.querySelectorAll(".talent-card")[i];
  card.classList.remove("locked");
  card.style.borderColor = "#50fa7b";

  activateTalentEffect(i);
  saveTalents();
}

/* 🛠️ Effets réels ---------------------------------------------------- */
function activateTalentEffect(i){
  switch (i){
    case 0: /* 💪 Force du clic */
      clickPower += 1;
      break;

    case 1: /* ⚙️ AutoPro : +1 auto-clicker toutes 5 min */
      if (!window.autoProInstalled){
        window.autoProInstalled = true;
        window.talentIntervals.push(setInterval(()=>{autoClickers++;updateDisplay();},300000));
      }
      break;

    case 2: /* 🌙 Cookies offline */
      localStorage.setItem("enableOffline","1");
      break;

    case 3: /* 🎁 Chance boostée ×1.5 */
      window.eventRarityBoost = 1.5;
      updateDisplay();
      break;

    case 4: /* 🔄 Double prestige */
      window.doublePrestige = true;
      break;

    case 5: /* 👻 Clic fantôme toutes 5 s */
      if (!window.ghostClickInstalled){
        window.ghostClickInstalled = true;
        window.talentIntervals.push(setInterval(()=>clickCookie(),5000));
      }
      break;

    case 6: /* 💬 Commentateur cosmique */
      if (!window.commentatorInstalled){
        window.commentatorInstalled = true;
        const msgs = [
          "La matrice du cookie s'effondre…",
          "Un ancien clic murmure…",
          "Ton doigt guide le destin."
        ];
        window.talentIntervals.push(setInterval(()=>{
          eventLog.unshift(msgs[Math.random()*msgs.length|0]);
        },15000));
      }
      break;

    case 7: /* 🧊 Inertie préservée (timestamp déjà géré) */
      break;

    case 8: /* 🎲 Événement truqué */
      if (!window.riggedInstalled){
        window.riggedInstalled = true;
        let rig = 0, orig = triggerRandomEvent;
        triggerRandomEvent = function(){
          rig++;
          if (rig === 5){
            rig = 0;
            const _r = Math.random;
            Math.random = () => 0.9 + _r()*0.1;
            orig();
            Math.random = _r;
          } else orig();
        };
      }
      break;

    case 9: /* 🧤 Clic miroir 5 % */
      if (!window.mirrorInstalled){
        window.mirrorInstalled = true;
        const origClick = clickCookie;
        clickCookie = function(){
          origClick();
          if (Math.random() < 0.05) origClick();
        };
      }
      break;
  }
}

/* 🚀 Applique les talents déjà débloqués au chargement -------------- */
document.addEventListener("DOMContentLoaded",()=>{
  document.getElementById("talentPoints").textContent = talentPoints;
  talents.forEach((t,idx)=>{
    if(t){
      const card=document.querySelectorAll(".talent-card")[idx];
      card.classList.remove("locked");
      card.style.borderColor="#50fa7b";
      activateTalentEffect(idx);
    }
  });
});

/* 🗑️ Réinitialisation complète des talents (appelle dans resetGame) */
function resetTalents(){
  talentPoints = 0;
  talents.fill(false);
  saveTalents();

  /* Réinitialise visuel */
  document.querySelectorAll(".talent-card").forEach(el=>{
    el.classList.add("locked");
    el.style.borderColor="#444";
  });

  /* Vide tous les intervals créés */
  window.talentIntervals.forEach(id=>clearInterval(id));
  window.talentIntervals = [];
  window.autoProInstalled = window.ghostClickInstalled =
  window.commentatorInstalled = window.riggedInstalled =
  window.mirrorInstalled = false;
  window.eventRarityBoost = 1;
  window.doublePrestige   = false;
  updateDisplay();
}

/* === Cookies offline simple --------------------------------------- */
window.addEventListener("beforeunload",()=>{
  if(localStorage.getItem("enableOffline")==="1")
    localStorage.setItem("lastSeen",Date.now());
});
const last = localStorage.getItem("lastSeen");
if(last && localStorage.getItem("enableOffline")==="1"){
  cookies += Math.floor((Date.now()-last)/1000)*clickPower;
}

</script>
</body>
</html>
